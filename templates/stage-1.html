<!DOCTYPE html>
<html lang="en">
  {% extends 'base.html' %} {% block content %}
  <div class="container-fluid">
      <h2>Welcome <span>{{ username }}</span> to stage 1</h2>
    <div class="row">
        <div class="zoom-window">
            <h5>Zoom window</h5>
        </div>

        <div id="googleMap" class="game-board"></div>

        <div class="game-controls">
            <h5>Clues</h5>
            
            <button type="button" class="btn btn-success btn-lg" id="start" onclick="start()">
            Start
            </button>
            <div id="timer"></div>
            {% for clue in clues %}
            <div class="card clue">
                <div class="card-body">
                    {{clue.step}}) {{clue.question}}

                    <input type="text" id="answer" name="answer" />
                    <button
                    type="button"
                    onclick="check_answer(question='{{clue.question}}', answer='{{clue.answer}}')"
                    class="btn btn-success btn-sm"
                    id="answer-button"
                    >
                    Submit
                    </button>
                </div>
            </div>

            {% endfor %}

           <div class="btn btn-danger" id="stop_timer" onclick="stop()">Stop time</div>
        </div>
    </div>
    <div class="">
        <h1>Leaderboard</h1>
        {% for team in teams %}
        <div class="card">
            <div class="card-body">
            <b>Team: </b>{{team.team_name.title()}} <b>Time: </b>{{team.time}}
            </div>
        </div>
        {% endfor %}
        </div>
    </div>
 

  <script>
    function myMap() {
      var mapProp = {
        center: new google.maps.LatLng(53.347234, -6.259278),
        zoom: 10,
      };
      var map = new google.maps.Map(
        document.getElementById("googleMap"),
        mapProp
      );
      var dublin = { lat: 53.347234, lng: -6.259278 };
      var marker = new google.maps.Marker({ position: dublin, map: map });
    }
  </script>
  <script>
    var timerActive = false;
    function start() {
        if (timerActive === false) {
            timerActive = true;
            timer = setInterval(countTimer, 1000);
        }       
    } 
    function stop() {
        if(timerActive === true) {
            timerActive = false;
            clearInterval(timer);
        }
    }

    var totalSeconds = 0;
    function countTimer() {
        ++totalSeconds;
        var hour = Math.floor(totalSeconds /3600);
        var minute = Math.floor((totalSeconds - hour*3600)/60);
        var seconds = totalSeconds - (hour*3600 + minute*60);
        if(hour < 10)
            hour = "0"+hour;
        if(minute < 10)
            minute = "0"+minute;
        if(seconds < 10)
            seconds = "0"+seconds;
        document.getElementById("timer").innerHTML = hour + ":" + minute + ":" + seconds;
    }


    function check_answer(question, answer) {
      console.log(question);
      console.log(answer);
      var user_answer = "";
      user_answer = document.getElementById("answer").value.toLowerCase();
      console.log("user_answer = " + user_answer);
      if (user_answer == answer) {
        console.log("Correct");
        document.getElementById("answer").remove();
        document.getElementById("answer-button").remove();
        $(".card.clue:visible").last().css("background-color", "#c4f2b7");
        $(".card.clue:visible").last().next(".clue:hidden").show();
      } else {
        console.log("Wrong");
        $(".card.clue:visible").last().css("background-color", "#f09a9a");
      }
    }
  </script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBoU38Bi9RaqnX0R46KvqIBbWsTO0Mf6ms&callback=myMap"></script>
  {% endblock%}
</html>
